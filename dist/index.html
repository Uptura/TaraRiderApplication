<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TARA</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="script.js"></script>
  
  <style>
    @keyframes pulseScale {
      0%, 100% {
        transform: scale(1); 
      }
      50% {
        transform: scale(1.05); 
      }
    }

    .animate-pulse-scale {
      animation: pulseScale 2s ease-in-out infinite;
    }

    html {
      scroll-behavior: smooth;
    }


    section[id] {
      scroll-margin-top: 6rem; 
    }
  </style>
</head>
<body class="bg-white">

  <nav class="bg-white shadow-md fixed top-0 left-0 w-full z-50">
    <div class="container mx-auto px-4 md:px-16 py-6 flex justify-between items-center">
      <a href="#" class="flex items-center">
        <img src="../image/tara-512.png" class="h-12 w-24 mr-6" alt="Tara Logo">
        <span class="text-2xl md:text-4xl font-bold">Tara</span>
      </a>
      <ul class="flex space-x-4 md:space-x-6">
        <li class="hidden"><a href="#services" class="text-gray-700 hover:text-blue-500">Services</a></li>
        <li class="hidden"><a href="#features" class="text-gray-700 hover:text-blue-500">Features</a></li>
        <li class="hidden"><a href="#about" class="text-gray-700 hover:text-blue-500">About Us</a></li>
        <li class="hidden"><a href="#contact" class="text-gray-700 hover:text-blue-500">Contact Us</a></li>
      </ul>
    </div>
  </nav>

  <header class="text-black pt-32">
    <div class="container mx-auto px-4 py-20 flex flex-col md:flex-row items-center">
      <div class="flex justify-center md:justify-start md:w-1/2 md:pl-12 lg:pl-50">
        <img src="../image/RiderRegister2.png" alt="ID Image" class="h-50 w-auto animate-pulse-scale">
      </div>
      <div class="text-center md:text-left md:w-1/2 md:pr-16 lg:pr-40">
        <h1 class="text-2xl md:text-4xl font-bold mb-4">Rider Registration</h1>
        <form id="form1" class="bg-white p-4 md:p-8 border border-gray-300 rounded-lg">
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="legal_name">Full Name</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="legal_name" type="text" placeholder="Legal Name" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="dl_id">Driver's Licence Number</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="dl_id" type="text" placeholder="DL ID" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="dl_expiration">Driver's License Expiration</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="dl_expiration" type="date" placeholder="DL Expiration" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="address">Address</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="address" type="text" placeholder="Address" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="phone_number">Phone Number</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="phone_number" type="tel" placeholder="Phone Number" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="email">Email</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="email" type="email" placeholder="Email" required>
          </div>
          <div class="flex items-center justify-between">
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300" type="button" onclick="validateForm1()">
              Next
            </button>
          </div>
        </form>

        <script>
          function validateForm1() {
            const fields = ['legal_name', 'dl_id', 'dl_expiration', 'address', 'phone_number', 'email'];
            let isValid = true;

            fields.forEach(fieldId => {
              const field = document.getElementById(fieldId);
              if (!field.value.trim()) {
          field.classList.add('border-red-500');
          isValid = false;
              } else {
          field.classList.remove('border-red-500');
              }
            });

            if (isValid) {
              showForm2();
            } else {
              alert('Please fill out all required fields.');
            }
          }
        </script>

        <form id="form2" class="bg-white p-4 md:p-8 border border-gray-300 rounded-lg hidden">
          <div class="mb-4 hidden">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="status">Status</label>
            <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="status" required>
              <option value="pending" selected>Pending</option>
              <option value="approved">Approved</option>
              <option value="under-review">Under-Review</option>
            </select>
          </div>
          <div class="mb-4">
          <script>
    
            function updateStatusToUnderReview() {
              const statusField = document.getElementById('status');
              statusField.value = 'under-review';
              console.log('Status updated to Under-Review');
            }
    
          </script>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="selfie_file">ID Image (Upload)</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="selfie_file" type="file" accept="image/*" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="id_photo_file">ORCR Image (Upload)</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="id_photo_file" type="file" accept="image/*" required>
          </div>
           <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="tgid">Telegram ID</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="tgid" type="text" placeholder="TGID" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="vehicle_type">Vehicle Type</label>
            <select class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="vehicle_type" required>
              <option value="" disabled selected>Select Vehicle Type</option>
              <option value="motorcycle">Motorcycle</option>
              <option value="car">Car</option>
              <option value="van">Van</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="color">Vehicle Color</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="color" type="text" placeholder="Color" required>
          </div>
          <div class="mb-4">
            <label class="block text-gray-700 text-sm font-bold mb-2" for="plate">Plate Number</label>
            <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="plate" type="text" placeholder="Plate" required>
          </div>
            <div class="flex items-center justify-between"></div>
            <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300" type="button" onclick="showForm1()">
              Back
            </button>
            <button 
              class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300" 
              type="button" 
              onclick="openConfirmationModal()">
              Submit
            </button>

            <!-- Confirmation Modal -->
            <div id="confirmationModal" class="fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center hidden">
              <div class="bg-white rounded-lg shadow-lg p-6 w-96">
              <h2 class="text-lg font-bold mb-4">Confirm Registration</h2>
              <p class="text-gray-700 mb-6">Do you want to submit your Rider Application?</p>
              <div class="flex justify-end space-x-4">
                <button class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded" onclick="closeConfirmationModal()">Cancel</button>
                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" onclick="confirmRegistration()">Proceed</button>
              </div>
              </div>
            </div>

            <script>
              function openConfirmationModal() {
              document.getElementById('confirmationModal').classList.remove('hidden');
              }

              function closeConfirmationModal() {
              document.getElementById('confirmationModal').classList.add('hidden');
              }

              function confirmRegistration() {
              closeConfirmationModal();
              if (validateAndSubmit()) {

                showLoadingAnimation();
                setTimeout(() => {
                window.location.href = "traininghomepage.html";
                }, 2000); // Simulate loading time
              }
              }

              function showLoadingAnimation() {
              const loadingDiv = document.createElement('div');
              loadingDiv.id = 'loading-animation';
              loadingDiv.style.position = 'fixed';
              loadingDiv.style.top = '0';
              loadingDiv.style.left = '0';
              loadingDiv.style.width = '100%';
              loadingDiv.style.height = '100%';
              loadingDiv.style.backgroundColor = 'rgba(255, 255, 255, 0.8)';
              loadingDiv.style.display = 'flex';
              loadingDiv.style.justifyContent = 'center';
              loadingDiv.style.alignItems = 'center';
              loadingDiv.style.zIndex = '9999';
              loadingDiv.innerHTML = '<div class="loader"></div>';

              const loaderStyle = document.createElement('style');
              loaderStyle.innerHTML = `
                .loader {
                border: 8px solid #f3f3f3;
                border-top: 8px solid #3498db;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                animation: spin 1s linear infinite;
                }
                @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
                }
              `;
              document.head.appendChild(loaderStyle);
              document.body.appendChild(loadingDiv);
              }
            </script>

            <script>
              function validateAndSubmit() {
              const fields = ['legal_name', 'dl_id', 'email', 'phone_number', 'address', 'dl_expiration', 'plate', 'tgid', 'vehicle_type', 'color', 'selfie_file', 'id_photo_file'];
              let isValid = true;
              let form1Fields = ['legal_name', 'dl_id', 'email', 'phone_number', 'address', 'dl_expiration'];
              let form2Fields = ['plate', 'tgid', 'vehicle_type', 'color', 'selfie_file', 'id_photo_file'];
              let form1Invalid = false;

              fields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (!field.value.trim()) {
                field.classList.add('border-red-500');
                isValid = false;
                if (form1Fields.includes(fieldId)) {
                  form1Invalid = true;
                }
                } else {
                field.classList.remove('border-red-500');
                }
              });

              if (!isValid) {
                alert('Please fill out all required fields.');
                if (form1Invalid) {
                showForm1();
                }
                return false;
              }

              const existingData = JSON.parse(localStorage.getItem('submittedData')) || [];
              const newData = fields.reduce((data, fieldId) => {
                data[fieldId] = document.getElementById(fieldId).value.trim();
                return data;
              }, {});

              const duplicateEmail = existingData.some(data => data['email'] === newData['email']);

              if (duplicateEmail) {
                alert('The Email already exists in the database. Please use a different email.');
                document.getElementById('email').classList.add('border-red-500');
                document.getElementById('email').focus();
                return false; // Prevent submission
              }

              const duplicateDL = existingData.some(data => data['dl_id'] === newData['dl_id']);

              if (duplicateDL) {
                alert('The Driver\'s License already exists in the database. Registration cannot proceed. Please use a different Driver\'s License.');
                document.getElementById('dl_id').classList.add('border-red-500');
                document.getElementById('dl_id').focus();
                showForm1(); // Ensure the user is redirected to the first form if they are on the second form
                return false; // Prevent submission
              }

              const duplicateTGIDOrPlate = ['tgid', 'plate'].find(fieldId =>
                existingData.some(data => data[fieldId] === newData[fieldId])
              );

              if (duplicateTGIDOrPlate) {
                const fieldName = duplicateTGIDOrPlate === 'tgid' ? 'Telegram ID' : 'Plate Number';
                alert(`The ${fieldName} already exists.`);
                document.getElementById(duplicateTGIDOrPlate).classList.add('border-red-500');
                document.getElementById(duplicateTGIDOrPlate).focus();
                return false; // Prevent submission
              }

              existingData.push(newData);
              localStorage.setItem('submittedData', JSON.stringify(existingData));
             
              return true;
              }
            </script>

            <script>
              function showForm2() {
              document.getElementById('form1').classList.add('hidden');
              document.getElementById('form2').classList.remove('hidden');
              }
            </script>

            <script>
              function showForm1() {
              document.getElementById('form2').classList.add('hidden');
              document.getElementById('form1').classList.remove('hidden');
              }
            </script>
          </div>
              </div>
            </div>
            </div>
         </form>
      </div>
    </div>
  </header>
</script>
</body>
</html>